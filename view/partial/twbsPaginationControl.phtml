<?php 

$oPaginationControlHelper = $this->plugin('paginationControl');

if ($this->pageCount) {
    echo '<nav'.$oPaginationControlHelper->attributesToString($this->attributes ?? [], 'div').'>' . PHP_EOL;
    echo '    <ul class="pagination">' . PHP_EOL;
    $sIndentation = '        ';

    // Generate previous link
    $aLiAttributes = ['class' => 'page-item'];
    $aPreviousAttributes = ['class' => 'page-link'];
    if(isset($this->previous)){
        $aPreviousAttributes['href'] = $this->url($this->route, ['page' => $this->previous]);
    }
    else{
        $aLiAttributes['class'] = 'disabled '.$aLiAttributes['class'];
        $aPreviousAttributes['href'] = '#';
        $aPreviousAttributes['tabindex'] = '-1';
    }

    echo $sIndentation . '<li' . $oPaginationControlHelper->attributesToString($aLiAttributes, 'li') . '>'.
    '<a' . $oPaginationControlHelper->attributesToString($aPreviousAttributes, 'a') . '>' . $this->translate('Previous') . '</a>'.
    '</li>' . PHP_EOL;

    // Generate pages
    foreach ($this->pagesInRange as $page) {

        $aLiAttributes = ['class' => 'page-item'];
        $aLinkAttributes = ['class' => 'page-link'];
        $sLinkContent = $page;

        if ($page != $this->current) {
            $aLinkAttributes['href'] = $this->url($this->route, ['page' => $page]);
        } else {
            $aLiAttributes['class'] = 'active ' . $aLiAttributes['class'];
            $aLinkAttributes['href'] = '#';
            $sLinkContent .= ' <span class="sr-only">'. $this->translate('(current)') . '</span>';
        }
        echo $sIndentation . '<li' . $oPaginationControlHelper->attributesToString($aLiAttributes, 'li') . '>'.
        '<a' . $oPaginationControlHelper->attributesToString($aLinkAttributes, 'a') . '>' . $sLinkContent . '</a>'.
        '</li>' . PHP_EOL;
    }

    // Generate next link
    $aLiAttributes = ['class' => 'page-item'];
    $aNextAttributes = ['class' => 'page-link'];
    if(isset($this->next)){
        $aNextAttributes['href'] = $this->url($this->route, ['page' => $this->next]);
    }
    else{
        $aLiAttributes['class'] = 'disabled ' . $aLiAttributes['class'];
        $aNextAttributes['href'] = '#';
        $aNextAttributes['tabindex'] = '-1';
    }

    echo $sIndentation . '<li' . $oPaginationControlHelper->attributesToString($aLiAttributes, 'li') . '>'.
    '<a' . $oPaginationControlHelper->attributesToString($aNextAttributes, 'a') . '>' . $this->translate('Next') . '</a>'.
    '</li>' . PHP_EOL;

    echo '    </ul>' . PHP_EOL . '</nav>';
}